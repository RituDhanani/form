<!doctype html>
<html lang="en">    
<head>
    <meta charset="utf-8">
    <title>demo</title>
</head>
<body>

<form id="userForm">
    <div id="errorMsg" style="color:red;"></div>
        <h1> Fill this Form</h1>

    <label for="name">Name:</label>
    <input type="text" id="name" name="name"  >
    <br><br>

    <label for="email">EmailId:</label>  
    <input type="email" id="email" name="email" >
    <br><br>

    <label for="gender">Gender:</label>
    <input type="radio" id="male" name="gender" value="male">
    <label for="male">Male</label>
    <input type="radio" id="female" name="gender" value="female">
    <label for="female">Female</label>
    <br><br>    

    <label for="hobbies">Hobbies:</label>
    <input type="checkbox" id="reading" name="hobbies" value="reading">
    <label for="reading">Reading</label>
    <input type="checkbox" id="travelling" name="hobbies" value="travelling">
    <label for="travelling">Travelling</label>
    <input type="checkbox" id="drawing" name="hobbies" value="drawing">
    <label for="drawing">Drawing</label>
    <input type="checkbox" id="writing" name="hobbies" value="writing">
    <label for="writing">Writing</label>
    <br><br>

    <label for="age">Age:</label>
    <input type="number" id="age" name="age" min="1" max="100">
    <br><br>

    <label>Country:</label>
    <select id="country" >
        <option value="">Select Country</option>
    </select>
    <br><br>

    <label>State:</label>
    <select id="state" >
        <option value="">Select State</option>
    </select>
    <br><br>

    <label>City:</label>
    <select id="city" >
        <option value="">Select City</option>
    </select>
    <br><br>

    <input type="submit" id="submitBtn" value="Submit">
    <button type="button" id="cancelBtn" style="display:none;">Cancel</button>
</form>

<hr>
<label>Search Name:</label>
<input type="text" id="searchInput" placeholder="Search...">
<br><br>

<label>Sort by Name: </label>
<select id="sortSelect">
    <option value="asc">Ascending</option>
    <option value="desc">Descending</option>
</select>
<br><br>

<h2>Table</h2>

<table id="dataTable">
    <style>
        table {
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 5px;
        }
    </style>
    <thead>
        <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Gender</th>
            <th>Hobbies</th>
            <th>Age</th>
            <th>Country</th>
            <th>State</th>
            <th>City</th>
            <th>time</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody id="tableBody"></tbody>
</table>

<script>
    
    const countryStateCityData = {
        India: {
            Gujarat: ["Surat", "Ahmedabad", "Vadodara"],
            Maharashtra: ["Mumbai", "Pune", "Nagpur"],
            Karnataka: ["Bangalore", "Mysore", "Mangalore"]
        },
        USA: {
            California: ["Los Angeles", "San Francisco", "San Diego"],
            Texas: ["Houston", "Dallas", "Austin"],
            Florida: ["Miami", "Orlando", "Tampa"]
        }
    };
    
    const countrySelect = document.getElementById("country");
    const stateSelect = document.getElementById("state");
    const citySelect = document.getElementById("city");
    for (const country in countryStateCityData) {
        countrySelect.add(new Option(country, country));
    }
    countrySelect.addEventListener("change", function () {
    stateSelect.innerHTML = '<option value="">Select State</option>';
    citySelect.innerHTML = '<option value="">Select City</option>';
    if (this.value) {
        for (let state in countryStateCityData[this.value]) {
            stateSelect.add(new Option(state, state));
        }
    }
});

stateSelect.addEventListener("change", function () {
    citySelect.innerHTML = '<option value="">Select City</option>';
     if (this.value) {
        countryStateCityData[countrySelect.value][this.value].forEach(city => citySelect.add(new Option(city, city)));
    }
});

    const userData = [
        {
            name: "Ritu",
            email: "ritu@gmail.com",
            gender: "female",
            hobbies: "reading, travelling",
            age: 25,
            country: "India",
            state: "Gujarat",
            city: "Surat",
            Time: "5:10:30"
        },
        {
            name: "khushi",
            email: "khushi@gmail.com",
            gender: "female",
            hobbies: "drawing, writing",
            age: 28,
            country: "India",
            state: "Maharashtra",
            city: "Mumbai",
            Time: "13:11:00 "
        }
    ];

    let editIndex = null;
    const tableBody = document.getElementById("tableBody");
    function sortByName(data) {
        const sortOrder = document.getElementById("sortSelect").value;
        return data.sort((a, b) => {
            return sortOrder === "asc" ? a.name.localeCompare(b.name) : b.name.localeCompare(a.name);
        });
    }

    function renderTable(filteredData = userData) {
        tableBody.innerHTML = "";
        const data = sortByName(filteredData);

        data.forEach(user => {
        
            const row = `
                <tr>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.gender}</td>
                    <td>${user.hobbies}</td>
                    <td>${user.age}</td>
                    <td>${user.country}</td>
                    <td>${user.state}</td>
                    <td>${user.city}</td>
                    <td>${user.Time}</td>
                    <td>
                        <button onclick="editUser(${userData.indexOf(user)})">Edit</button>
                        <button onclick="deleteUser(${userData.indexOf(user)})">Delete</button>
                    </td>
                </tr>`;
            tableBody.innerHTML += row;
        });
    }

     document.addEventListener("DOMContentLoaded", () => {
        renderTable(); 
    });
    document.getElementById("sortSelect").addEventListener("change", function() {
        renderTable();
    });

    

    document.getElementById("searchInput").addEventListener("input", function() {
        const searchTerm = this.value.toLowerCase();
        const filteredData = userData.filter(user => user.name.toLowerCase().includes(searchTerm));
        renderTable(filteredData);
    });

    window.onload = function() {
        renderTable();
    };  

    document.getElementById("userForm").addEventListener("submit", function(e) {
        e.preventDefault();
        document.getElementById("errorMsg").innerText = "";
        let error=[];
        const name = document.getElementById("name").value;
        const email = document.getElementById("email").value;
        const gender = document.querySelector('input[name="gender"]:checked');
        const hobbies = Array.from(document.querySelectorAll('input[name="hobbies"]:checked')).map(h => h.value).join(", ");
        const age = document.getElementById("age").value;
      
       

            if (!name) {
                error.push("Name is required.");
            }
            if (!email) {
                error.push("Email is required.");
            }
            if (!gender) {
                error.push("Gender is required.");
            }
            if (!hobbies) {
                    error.push("At least one hobby must be selected.");
           }  
            if (!age || age < 1 || age > 100) {
                error.push("Age must be between 1 and 100.");
            }
             if (error.length > 0) {
                document.getElementById("errorMsg").innerText = error.join(" ");
                return;
            }

        const country = document.getElementById("country").value;
        const state = document.getElementById("state").value;
        const city = document.getElementById("city").value;
          

        const newUser = {
            name:name,
            email: email,
            gender: gender.value,
            hobbies: hobbies,
            age: age,
            country: country,
            state: state,
            city: city,
            Time: new Date().toLocaleTimeString()
        };
        if (editIndex !== null) {
            userData[editIndex] = newUser;
            editIndex = null;
            document.getElementById("submitBtn").value = "Submit";
            document.getElementById("cancelBtn").style.display = "none";
        } else {
            userData.push(newUser);
        }
        renderTable();
        this.reset();
    });
    
    function editUser(index) {
        const user = userData[index];
        editIndex = index;
        document.getElementById("name").value = user.name;
        document.getElementById("email").value = user.email;
        document.getElementById("age").value = user.age;
        document.getElementById("country").value = user.country;
        countrySelect.dispatchEvent(new Event('change'));
        document.getElementById("state").value = user.state;
        stateSelect.dispatchEvent(new Event('change'));
        document.getElementById("city").value = user.city;
        document.querySelector(`input[name="gender"][value="${user.gender}"]`).checked = true;  
        document.querySelectorAll('input[name="hobbies"]').forEach(h => { h.checked = user.hobbies.includes(h.value); });
        document.getElementById("submitBtn").value = "Update";
        document.getElementById("cancelBtn").style.display = "inline";
    }
    function deleteUser(index) {
        userData.splice(index, 1);
        renderTable();
    
    }
    
    document.getElementById("cancelBtn").addEventListener("click", function() {
        document.getElementById("userForm").reset();
        editIndex = null;
        document.getElementById("submitBtn").value = "Submit";
        this.style.display = "none";
    });

</script>
</body>
</html> 


